<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Coalition Builder</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <style>
        body {
            color: black;
            font-family: 'Tahoma';
            margin:2%;
        }

        h3 {
            font-family: 'Tahoma';
            color: black;
            text-align: left;
            vertical-align: top;
            font-size: 18px;
            padding: 5px;
            margin: 5px;
        }

        h2 {
            font-family: 'Brush Script MT';
            text-align: center;
            font-size: 50px;
        }

        b {
            font-family: 'Tahoma';
        }

        button {
            padding: 5px;
            font-size: 25px;
            height: 100%;
            width: 100%;
        }

        input {
            width: 110%
        }

        td {
            padding: 10px;
            outline-style: none solid none none;
        }

        .Color {
            width: 50%;
        }

        .small {
            font-size: 9px
        }

        div {
        }

        .Button {
            padding: 5px;
        }

        .scrollable {
            overflow-y:auto;
        }

        .PollRow {
            background-color: #ffff;
            border-color: cadetblue;
            border-style: solid;
        }

        .PollRow:hover {
                background-color: #b6ff00;
        }

        .container {
            width:100%;
        }

        /* The switch - the box around the slider */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 20px;
        }

        /* Hide default HTML checkbox */
        .switch input {
                opacity: 0;
                width: 0;
                height: 0;
        }

        /* The slider */
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .chart-container{

        }

        .container {
            margin-top: 20px;
        }

        /* The sidebar menu */
        .sidebar {
            height: 100%; /* 100% Full-height */
            width: 0; /* 0 width - change this with JavaScript */
            position: fixed; /* Stay in place */
            z-index: 1; /* Stay on top */
            top: 10;
            right: 0;
            border-style:solid;
            background-color: #FFF;
            overflow-x: hidden; /* Disable horizontal scroll */
            padding-top: 60px; /* Place content 60px from the top */
            transition: 0.5s; /* 0.5 second transition effect to slide in the sidebar */
        }

         /* The sidebar links */
        .sidebar a {
                padding: 8px 8px 8px 32px;
                text-decoration: none;
                font-size: 25px;
                display: block;
                transition: 0.3s;
        }

         /* When you mouse over the navigation links, change their color */
        .sidebar a:hover {
                    color: #f1f1f1;
        }

            /* Position and style the close button (top right corner) */
        .sidebar .closebtn {
                position: absolute;
                top: 0;
                left: 0;
                font-size: 36px;
        }

        /* The button used to open the sidebar */
        .openbtn {
            font-size: 20px;
            cursor: pointer;
            padding: 10px 15px;
            border: none;
        }

        .openbtn:hover {
                background-color: #444;
        }

        /* Style page content - use this if you want to push the page content to the right when you open the side navigation */
        #main {
        }

        /* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a smaller font size) */
        @media screen and (max-height: 450px) {
            .sidebar {
                padding-top: 15px;
            }

                .sidebar a {
                    font-size: 18px;
              }
        } 

        .slider:before {
                position: absolute;
                content: "";
                height: 10px;
                width: 10px;
                left: 4px;
                bottom: 4px;
                background-color: white;
                -webkit-transition: .4s;
                transition: .4s;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(40px);
            -ms-transform: translateX(40px);
            transform: translateX(40px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
                border-radius: 50%;
        }
        .highcharts-figure,
        .highcharts-data-table table {
            min-width: 320px;
            max-width: 800px;
            margin: 1em auto;
        }
        .highcharts-data-table table {
            font-family: Verdana, sans-serif;
            border-collapse: collapse;
            border: 1px solid #ebebeb;
            margin: 10px auto;
            text-align: center;
            width: 100%;
            max-width: 500px;
        }
    </style>
</head>
<body>
    <div>
        <h2>
            Schmillies Tasmanian Coaliton Calculator
            <img src="https://upload.wikimedia.org/wikipedia/commons/1/11/Tasmania_location_map_alt.png"
                 style="height:55px;" />
            <br />
            <text style="font-family: 'Tahoma'; font-size: small">
                <b>Made at the request of and via harrasment by Leo Pugsli and</b>
                <img src="https://static.wixstatic.com/media/760046_dd30c7eacdd947f1b1bff19626a623fa~mv2.png/v1/fill/w_183,h_61,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/760046_dd30c7eacdd947f1b1bff19626a623fa~mv2.png" alt="" style="width: 183px; height: 61px; object-fit: cover;" width="183" height="61" srcset="https://static.wixstatic.com/media/760046_dd30c7eacdd947f1b1bff19626a623fa~mv2.png/v1/fill/w_183,h_61,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/760046_dd30c7eacdd947f1b1bff19626a623fa~mv2.png" fetchpriority="high">
            </text>
        </h2>
    </div>
    <div id="main" style="height:341px; width: 100%; padding: 2px;">
        <div id="TopRow" class="row">
            <div class="col-md-4 chart-container" id="SeatContainer">
                <div id="SeatChart">
                    <figure class="highcharts-figure"></figure>
                </div>
            </div>
            <div class="col-md-4 chart-container" id="SmoothContainer">
                <div id="SmoothChart">
                    <canvas id="SmoothCircle">
                    </canvas>
                </div>
                <h3>Click on a party to add the to a coaliton.</h3>
            </div>
            <div class="col-md-1" id="RightChartInfo">
                <h3>Majority Needed <br /> <b id="Threshold">50</b> </h3>
                <h3>Currently Selected <br /> <b id="CurrentValue">0</b> </h3>
                <h3>Majority: <br /> <b id="Majority">false</b></h3>
                <h3>Lock to: <b id="MaxCount"></b></h3>
                <label class="switch">
                    <input onclick="LockToggle()" type="checkbox" id="CheckBox">
                    <span class="slider round"></span>
                </label>
            </div>
            <div class="col-md-1">
                <h3>
                    <b>Type:</b><br /> <text id="Type"></text>
                </h3>
                <h3 class="scrollable">
                    Selected Parties: <b id="elementList"></b>
                </h3>
            </div>
            <div class="col-md-1">
                <button onclick="ChangeMode()" type="button">
                    <text>Toggle Mode</text> <br />
                </button>
                <button onclick="RenderChart()" type="button">Refresh </button>
                <button onclick="buttonClear()" type="button">Clear</button>
                <button onclick="buttonClear()" type="button">Add Party</button>
            </div>
            <div class="col-md-1">
                <button class="openbtn" onclick="openNav()">◁ Select Poll</button>
            </div>
            <div id="mySidebar" class="sidebar" style="height:50%;">
                <h3>
                    Based on Poll:
                </h3>
                <div class="scrollable">
                    <table id="pollingData" style="height:30px">
                    </table>
                    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
                </div>
            </div>
        </div>
    </div>
    <div id="BoxesContainer" class="row" style="padding:1%;">
        <div id="PartyRow" class="PartyRow container">
        </div>
    </div>
    <div class="row"><div style="padding-left: 10%;" class="col">
    <b> Known Bugs: </b>
    <ul>
        <li>- Seat mode broken, currently does not interact with coaltion. have to click on primary chart to change values</li>
        <li>- Rescaling of graphs isn't very good and can cause issues </li>
        <li>- Currently doesn't doesn't allow for adding parties, can only change current values</li>
        <li>- Lock button has issues when interacting with 0</li>
    </ul>
    If you find any additonal issues please report them to <a href="mailto:schmilly@proton.me">my email</a>
    <br />
    Data Links:
    https://au.yougov.com/politics/articles/48296-the-tasmanian-state-liberal-vote-is-down-17-since-the-last-election
    https://en.wikipedia.org/wiki/2024_Tasmanian_state_election
</div>
    </div>
</body>
</html>
<script src="./polling.js"></script>
<script src="./functions.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/item-series.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
<script>
    var ctx = document.getElementById('SmoothCircle');
    var Type = PollingData[0].Level;
    var PartyCount = new Array();
    var PartyData = new Array();
    var SeatCount = new Array();
    var PrtyLabels = new Array();
    var colors = new Array();
    var SeatMajority = PollingData[0].SeatMajor;
    var TotalPrim = ArraySum(PollingData[0].PartyData);
    var TotalSeat = ArraySum(PollingData[0].SeatProj);
    var SeatMax = PollingData[0].SeatMax;
    assignPoll(0);
    var Max = 100;
    var Selected = [];
    var Row = 1;
    var CurrentTotal = 1;
    var BothChart = 1;
    //0 for 1 chart,1 for both charts 
    var CountLock = 0;
    //0 for unlock, 1 for Lock
    var Seat = 0;
    //0 for % mode, 1 for Seat Mode

    var SmoothData = {
        type: 'doughnut',
        data: {
            labels: PrtyLabels,
            datasets: [{
                label: '%',
                data: PartyData,
                borderWidth: 1,
                backgroundColor: colors
            }]
        },
        options: {
            rotation: -90,
            circumference: 180,
            maintainAspectRatio: false,
            onClick: handleChartClick,
            plugins: {
                legend: {
                    position: "bottom",
                }
            }
        }
    };

    ParlimentData = generateParlimentdata(colors, PrtyLabels, SeatCount, PartyCount);
    var HighChartsData = {
        chart: {
            type:'item',
            borderWidth: 0,
            reflow: true,
            height: 338-28,
            spacingTop: 0,
            spacingRight: 0,
            spacingBottom: 0,
            spacingLeft: 0,
            plotBorderWidth: 0,
            marginRight: 0,//-60, //this does move the chart but you'll need to recompute it
            marginLeft: 0,//-60,  //whenever the page changes width
            marginTop: 0,
            marginBottom: 0
        },
        title: {
            text: "",
        },
        series: [{
            name: 'Seats',
            keys: ['name', 'y', 'color'],
            data: ParlimentData,
            dataLabels: {
                enabled: false,
            },

            // Circular options
            center: ['50%', '88%'],
            size: '170%',
            startAngle: -90,
            endAngle: 90,
        }],
        plotOptions: {
            series: {
                states: {
                    inactive: {
                        opacity: 1
                    }
                }
            }
        },
    };

    createPage();
    RenderChart();
    grabPolling();
    PushPageValues();
    LockCheck();
</script>
